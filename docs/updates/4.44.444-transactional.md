---
date: 2023-09-02
description: Upgrade Sprout Transactional module 4.44.444
---

# Upgrading to Transactional v4.44.444

The Transactional Email Module no manages the core notification email functionality.

Email Types can now be configured and allow you to create transactional emails with custom Field Layouts, Templates, and Mailer Settings.

Notification Events have been rebuilt to use Craft's new Condition Builder, for more flexibility when creating your Notification Events.

Review all rules and test notifications after upgrade. We've tried to migrate all settings but the condition builder can handle much more advanced use cases with Drafts/Revisions/Sites and you should test and confirm it behaves the way you expect.

## Breaking Changes

### When New and When Updated Events are now separate

NOTIFICATION EVENT BREAKING CHANGE: Only "When New" OR "When Updated" can be selected now, so we've migrated "When Updated" and you will have to duplicate and add a second notification for "When New".

Code comment say that the Entry Save Notification Event
// Does not match the scenario where a new entry is disabled
// or where a new entry has a future publish date.
Or have info message say "To capture the scenario where a publish date in the future automatically converts an entry to "live" without an event, you will need to set the
email event to "none" and trigger those emails via a cron job that manually sends the appropriate email.
Or just add this to the DOCS.

Changed Notification Event class names and broke out SaveUser and SaveEntry into TWO events, which both handle their event specific logic.

- ENTRY When NEW and When UPDATED events
- USER When NEW and When UPDATED events

### Send Method is retired. All emails will be sent as Lists.

### Send Rules have been migrated to use Twig Expression Condition Rule

Send Rule => Twig Expression Condition Rule
And now instead of $emailType->getAdditionalTemplateVariables()
it's just the $element that gets evaluated as the object variable.
BREAKING CHANGE: If your custom Events use Send Rule for anything other
than an Element that the event is triggered by, you'll need to move that
logic into you custom event settings or handle it manually in the matchNotificationEvent
method.

** Remove Send Rule and make it Twig Expression condition Rule
** "Twig Expression is True". (may need to indicate what it does in the name)
    can always just evaluate

### On Save User Event handles Admin users differently

// On Save User Event: Only migrate admin setting if no $sectionIds are selected
Need to manually create new event if you were sending to both admins and groups
Or place your Admins in a group and send to that group too.

### Mailer settings columns have been changed to a JSON column

Any custom email queries that touch these fields will need to now target JSON::mailerInstructionsSettings
These Email field columns are deleted and moved to mailerInstructionsSettings
'fromName' => $this->string(),
'fromEmail' => $this->string(),
'replyToEmail' => $this->string(),
'recipients' => $this->text(),

### Custom Notification Event

Custom Notification Events will need to update several things. See the base class for details.

- `getEventObject` => `getEventVariables`
- `getMockEventObject` => `getMockEventVariables`
- These methods can now return any variables they want instead of just an `object` variable

If your custom Events use Send Rule for anything other
than an Element that the event is triggered by, you'll need to move that
logic into you custom event settings or handle it manually in the matchNotificationEvent
method.

### Sprout Lists has been retired and replaced with the Audiences module

Sprout List Elements have been converted into AudienceElement
Manually review them and confirm settings are what you want. New settings that don't match old now.
Also, template updates needed => sprout.audiences.all() etc.

### Subscriber Lists will only migrate User lists

Lists will ONLY MIGRATE users
Any other uses of Lists need to be manually migrated.
Other uses should now be handled via Audiences and Data Sets and may require a custom module.
Focus now on Subscriber List use case only and other use caess handled by Audience integrations.
Removed 'elementId' => $this->integer()->notNull(), from Audience table. ID is now the only Element ID.

            Subscriber Lists now support settings around which User Statuses will trigger emails.

### Framework

- See the general [upgrade guide][#400-framework] for Sprout Modules to 4.0

[#400-framework]: ../updates/4.0.0-framework.md
